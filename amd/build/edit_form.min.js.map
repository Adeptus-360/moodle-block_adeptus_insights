{"version":3,"file":"edit_form.min.js","sources":["../src/edit_form.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JavaScript for the block edit form - report selection UI with searchable dropdown.\n *\n * @module     block_adeptus_insights/edit_form\n * @copyright  2025 Adeptus Analytics\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/str', 'core/notification'], function($, Str, Notification) {\n    'use strict';\n\n    /**\n     * Report Selector class for managing report selection in the edit form.\n     *\n     * @param {Object} options Configuration options\n     */\n    var ReportSelector = function(options) {\n        this.mode = options.mode || 'kpi'; // 'kpi' or 'tabs'\n        this.apiKey = options.apiKey || '';\n        this.containerId = options.containerId;\n        this.textareaName = options.textareaName;\n        this.container = null;\n        this.textarea = null;\n        this.reports = [];\n        this.filteredReports = [];\n        this.selectedReports = [];\n        this.strings = {};\n        this.searchTimeout = null;\n        this.highlightedIndex = -1;\n        this.isDropdownOpen = false;\n\n        this.init();\n    };\n\n    ReportSelector.prototype = {\n        /**\n         * Initialize the report selector.\n         */\n        init: function() {\n            var self = this;\n\n            this.container = $('#' + this.containerId);\n            this.textarea = $('[name=\"' + this.textareaName + '\"]');\n\n            if (!this.container.length || !this.textarea.length) {\n                return;\n            }\n\n            // Load existing selection from textarea\n            this.loadExistingSelection();\n\n            // Load language strings\n            this.loadStrings().then(function() {\n                // Render the UI\n                self.render();\n\n                // Fetch reports from API\n                self.fetchReports();\n\n                // Bind events\n                self.bindEvents();\n\n                // Show container\n                self.container.show();\n            });\n        },\n\n        /**\n         * Load language strings.\n         *\n         * @return {Promise}\n         */\n        loadStrings: function() {\n            var self = this;\n            return Str.get_strings([\n                {key: 'addreport', component: 'block_adeptus_insights'},\n                {key: 'removereport', component: 'block_adeptus_insights'},\n                {key: 'noreportsselected', component: 'block_adeptus_insights'},\n                {key: 'selectareport', component: 'block_adeptus_insights'},\n                {key: 'loading', component: 'block_adeptus_insights'},\n                {key: 'config_alert_report_placeholder', component: 'block_adeptus_insights'}\n            ]).then(function(strings) {\n                self.strings = {\n                    addreport: strings[0],\n                    removereport: strings[1],\n                    noreportsselected: strings[2],\n                    selectareport: strings[3],\n                    loading: strings[4],\n                    searchplaceholder: strings[5] || 'Search reports by name, category, or type...'\n                };\n            });\n        },\n\n        /**\n         * Load existing selection from textarea.\n         */\n        loadExistingSelection: function() {\n            try {\n                var value = this.textarea.val();\n                if (value) {\n                    this.selectedReports = JSON.parse(value);\n                }\n            } catch (e) {\n                this.selectedReports = [];\n            }\n        },\n\n        /**\n         * Render the report selector UI with searchable dropdown.\n         */\n        render: function() {\n            var modeLabel = this.mode === 'kpi' ? 'KPI Reports' : 'Tab Reports';\n            var uniqueId = this.mode + '-search-' + Date.now();\n\n            var html = '<div class=\"report-selector-ui\">' +\n                '<div class=\"report-selector-header d-flex justify-content-between align-items-center mb-2\">' +\n                '<span class=\"font-weight-bold\">' + modeLabel + '</span>' +\n                '<span class=\"badge badge-secondary report-count\">0 selected</span>' +\n                '</div>' +\n\n                // Searchable dropdown container\n                '<div class=\"report-selector-search-container mb-3 position-relative\">' +\n                '<div class=\"input-group\">' +\n                '<div class=\"input-group-prepend\">' +\n                '<span class=\"input-group-text\"><i class=\"fa fa-search\"></i></span>' +\n                '</div>' +\n                '<input type=\"text\" class=\"form-control report-search-input\" ' +\n                'id=\"' + uniqueId + '\" ' +\n                'placeholder=\"' + this.strings.searchplaceholder + '\" ' +\n                'autocomplete=\"off\" ' +\n                'aria-haspopup=\"listbox\" ' +\n                'aria-expanded=\"false\">' +\n                '<div class=\"input-group-append\">' +\n                '<button type=\"button\" class=\"btn btn-primary report-selector-add-btn\" disabled>' +\n                '<i class=\"fa fa-plus\"></i> ' + this.strings.addreport +\n                '</button>' +\n                '</div>' +\n                '</div>' +\n\n                // Dropdown results container\n                '<div class=\"report-search-dropdown position-absolute w-100 bg-white border rounded shadow-sm\" ' +\n                'style=\"display:none; z-index:1050; max-height:350px; overflow-y:auto; top:100%; left:0;\">' +\n                '<div class=\"report-search-results\"></div>' +\n                '<div class=\"report-search-empty text-muted text-center py-3\" style=\"display:none;\">' +\n                '<i class=\"fa fa-search\"></i> No matching reports found' +\n                '</div>' +\n                '<div class=\"report-search-loading text-center py-3\" style=\"display:none;\">' +\n                '<i class=\"fa fa-spinner fa-spin\"></i> ' + this.strings.loading +\n                '</div>' +\n                '</div>' +\n                '</div>' +\n\n                // Selected reports list\n                '<div class=\"report-selector-list-container\">' +\n                '<ul class=\"list-group report-selector-list\"></ul>' +\n                '<div class=\"report-selector-empty text-muted text-center py-3\">' +\n                '<i class=\"fa fa-inbox fa-2x mb-2\"></i><br>' +\n                this.strings.noreportsselected +\n                '</div>' +\n                '</div>' +\n                '</div>';\n\n            this.container.html(html);\n            this.updateListDisplay();\n            this.updateSelectedCount();\n        },\n\n        /**\n         * Fetch reports from the API.\n         */\n        fetchReports: function() {\n            var self = this;\n\n            if (!this.apiKey) {\n                this.container.find('.report-search-loading').hide();\n                this.container.find('.report-search-empty').show().html(\n                    '<i class=\"fa fa-exclamation-triangle\"></i> API key not configured'\n                );\n                return;\n            }\n\n            this.container.find('.report-search-loading').show();\n\n            var baseUrl = 'https://a360backend.stagingwithswift.com/api/v1';\n\n            // Fetch both wizard and AI reports\n            $.when(\n                $.ajax({\n                    url: baseUrl + '/wizard-reports',\n                    method: 'GET',\n                    headers: {\n                        'Authorization': 'Bearer ' + this.apiKey,\n                        'Accept': 'application/json'\n                    },\n                    timeout: 15000\n                }),\n                $.ajax({\n                    url: baseUrl + '/ai-reports',\n                    method: 'GET',\n                    headers: {\n                        'Authorization': 'Bearer ' + this.apiKey,\n                        'Accept': 'application/json'\n                    },\n                    timeout: 15000\n                })\n            ).then(function(wizardResult, aiResult) {\n                var allReports = [];\n\n                // Process wizard reports\n                var wizardReports = wizardResult[0].reports || wizardResult[0].data || [];\n                wizardReports.forEach(function(r) {\n                    r.source = 'wizard';\n                    r.displayName = r.name || r.title || r.display_name || r.slug;\n                    r.categoryName = r.category_info ? r.category_info.name : 'General';\n                    allReports.push(r);\n                });\n\n                // Process AI reports\n                var aiReports = aiResult[0].reports || aiResult[0].data || [];\n                aiReports.forEach(function(r) {\n                    r.source = 'ai';\n                    r.displayName = r.name || r.title || r.display_name || r.slug;\n                    r.categoryName = r.category_info ? r.category_info.name : 'AI Generated';\n                    allReports.push(r);\n                });\n\n                // Sort alphabetically by name\n                allReports.sort(function(a, b) {\n                    return a.displayName.localeCompare(b.displayName);\n                });\n\n                self.reports = allReports;\n                self.filteredReports = self.getAvailableReports();\n                self.container.find('.report-search-loading').hide();\n                self.renderSelectedList();\n            }).fail(function() {\n                self.container.find('.report-search-loading').hide();\n                Notification.addNotification({\n                    message: 'Failed to load reports',\n                    type: 'error'\n                });\n            });\n        },\n\n        /**\n         * Get reports that haven't been selected yet.\n         *\n         * @return {Array}\n         */\n        getAvailableReports: function() {\n            var self = this;\n            return this.reports.filter(function(report) {\n                return !self.selectedReports.some(function(s) {\n                    return s.slug === report.slug && s.source === report.source;\n                });\n            });\n        },\n\n        /**\n         * Filter reports based on search query.\n         *\n         * @param {string} query Search query\n         * @return {Array} Filtered reports\n         */\n        filterReports: function(query) {\n            var available = this.getAvailableReports();\n\n            if (!query || query.length < 1) {\n                return available;\n            }\n\n            query = query.toLowerCase().trim();\n            var terms = query.split(/\\s+/);\n\n            return available.filter(function(report) {\n                var searchText = (\n                    report.displayName + ' ' +\n                    report.categoryName + ' ' +\n                    report.source + ' ' +\n                    (report.slug || '')\n                ).toLowerCase();\n\n                // All terms must match\n                return terms.every(function(term) {\n                    return searchText.indexOf(term) !== -1;\n                });\n            }).slice(0, 50); // Limit to 50 results for performance\n        },\n\n        /**\n         * Render the search dropdown results.\n         *\n         * @param {string} query Current search query for highlighting\n         */\n        renderSearchResults: function(query) {\n            var self = this;\n            var resultsContainer = this.container.find('.report-search-results');\n            var emptyContainer = this.container.find('.report-search-empty');\n\n            resultsContainer.empty();\n\n            if (this.filteredReports.length === 0) {\n                emptyContainer.show();\n                return;\n            }\n\n            emptyContainer.hide();\n\n            // Group by category\n            var byCategory = {};\n            this.filteredReports.forEach(function(report) {\n                var cat = report.categoryName || 'Other';\n                if (!byCategory[cat]) {\n                    byCategory[cat] = [];\n                }\n                byCategory[cat].push(report);\n            });\n\n            var index = 0;\n            Object.keys(byCategory).sort().forEach(function(category) {\n                // Category header\n                resultsContainer.append(\n                    '<div class=\"report-search-category px-3 py-1 bg-light border-bottom\">' +\n                    '<small class=\"text-muted font-weight-bold\">' + self.escapeHtml(category) + '</small>' +\n                    '</div>'\n                );\n\n                // Reports in category\n                byCategory[category].forEach(function(report) {\n                    var highlightedName = self.highlightMatch(report.displayName, query);\n                    var sourceBadge = report.source === 'ai'\n                        ? '<span class=\"badge badge-info ml-2\">AI</span>'\n                        : '<span class=\"badge badge-primary ml-2\">Wizard</span>';\n\n                    var itemHtml = '<div class=\"report-search-item px-3 py-2 cursor-pointer\" ' +\n                        'data-index=\"' + index + '\" ' +\n                        'data-slug=\"' + report.slug + '\" ' +\n                        'data-source=\"' + report.source + '\" ' +\n                        'role=\"option\" ' +\n                        'tabindex=\"-1\">' +\n                        '<div class=\"d-flex justify-content-between align-items-center\">' +\n                        '<span class=\"report-name\">' + highlightedName + '</span>' +\n                        sourceBadge +\n                        '</div>' +\n                        '</div>';\n\n                    resultsContainer.append(itemHtml);\n                    index++;\n                });\n            });\n\n            // Apply hover styling\n            resultsContainer.find('.report-search-item')\n                .css('cursor', 'pointer')\n                .hover(\n                    function() {\n                        $(this).addClass('bg-light');\n                        self.highlightedIndex = parseInt($(this).data('index'), 10);\n                        self.updateHighlight();\n                    },\n                    function() {\n                        $(this).removeClass('bg-light');\n                    }\n                );\n        },\n\n        /**\n         * Highlight matching text in a string.\n         *\n         * @param {string} text Text to highlight\n         * @param {string} query Search query\n         * @return {string} HTML with highlighted matches\n         */\n        highlightMatch: function(text, query) {\n            if (!query || !text) {\n                return this.escapeHtml(text);\n            }\n\n            var escaped = this.escapeHtml(text);\n            var terms = query.toLowerCase().trim().split(/\\s+/);\n\n            terms.forEach(function(term) {\n                if (term.length > 0) {\n                    var regex = new RegExp('(' + term.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&') + ')', 'gi');\n                    escaped = escaped.replace(regex, '<mark class=\"bg-warning px-0\">$1</mark>');\n                }\n            });\n\n            return escaped;\n        },\n\n        /**\n         * Update the highlighted item in dropdown.\n         */\n        updateHighlight: function() {\n            var items = this.container.find('.report-search-item');\n            items.removeClass('bg-primary text-white');\n\n            if (this.highlightedIndex >= 0 && this.highlightedIndex < items.length) {\n                var item = items.eq(this.highlightedIndex);\n                item.addClass('bg-primary text-white');\n\n                // Scroll into view\n                var dropdown = this.container.find('.report-search-dropdown');\n                var itemTop = item.position().top;\n                var itemHeight = item.outerHeight();\n                var dropdownHeight = dropdown.height();\n                var scrollTop = dropdown.scrollTop();\n\n                if (itemTop < 0) {\n                    dropdown.scrollTop(scrollTop + itemTop);\n                } else if (itemTop + itemHeight > dropdownHeight) {\n                    dropdown.scrollTop(scrollTop + itemTop + itemHeight - dropdownHeight);\n                }\n            }\n        },\n\n        /**\n         * Open the search dropdown.\n         */\n        openDropdown: function() {\n            if (this.isDropdownOpen) {\n                return;\n            }\n\n            this.isDropdownOpen = true;\n            this.highlightedIndex = -1;\n\n            var dropdown = this.container.find('.report-search-dropdown');\n            var input = this.container.find('.report-search-input');\n\n            dropdown.show();\n            input.attr('aria-expanded', 'true');\n\n            // Render current results\n            var query = input.val();\n            this.filteredReports = this.filterReports(query);\n            this.renderSearchResults(query);\n        },\n\n        /**\n         * Close the search dropdown.\n         */\n        closeDropdown: function() {\n            if (!this.isDropdownOpen) {\n                return;\n            }\n\n            this.isDropdownOpen = false;\n            this.highlightedIndex = -1;\n\n            var dropdown = this.container.find('.report-search-dropdown');\n            var input = this.container.find('.report-search-input');\n\n            dropdown.hide();\n            input.attr('aria-expanded', 'false');\n        },\n\n        /**\n         * Handle search input.\n         *\n         * @param {string} query Search query\n         */\n        handleSearch: function(query) {\n            var self = this;\n\n            // Clear previous timeout\n            if (this.searchTimeout) {\n                clearTimeout(this.searchTimeout);\n            }\n\n            // Debounce search\n            this.searchTimeout = setTimeout(function() {\n                self.filteredReports = self.filterReports(query);\n                self.renderSearchResults(query);\n                self.highlightedIndex = -1;\n            }, 150);\n        },\n\n        /**\n         * Select the currently highlighted item.\n         */\n        selectHighlightedItem: function() {\n            if (this.highlightedIndex < 0 || this.highlightedIndex >= this.filteredReports.length) {\n                return;\n            }\n\n            var report = this.filteredReports[this.highlightedIndex];\n            this.addReport(report);\n        },\n\n        /**\n         * Add a report to the selection.\n         *\n         * @param {Object} report Report object\n         */\n        addReport: function(report) {\n            // Add to selected list\n            this.selectedReports.push({\n                slug: report.slug,\n                source: report.source,\n                name: report.displayName || report.name || report.title || report.slug\n            });\n\n            this.saveSelection();\n            this.updateSelectedCount();\n\n            // Update available reports and re-render\n            this.filteredReports = this.getAvailableReports();\n\n            // Clear search and close dropdown\n            var input = this.container.find('.report-search-input');\n            input.val('');\n            this.closeDropdown();\n\n            // Re-render selected list\n            this.renderSelectedList();\n        },\n\n        /**\n         * Render the selected reports list.\n         */\n        renderSelectedList: function() {\n            var self = this;\n            var list = this.container.find('.report-selector-list');\n            list.empty();\n\n            this.selectedReports.forEach(function(selected, index) {\n                // Find full report info\n                var report = self.reports.find(function(r) {\n                    return r.slug === selected.slug && r.source === selected.source;\n                });\n\n                var name = selected.name || (report ? report.displayName : selected.slug);\n                var categoryName = report ? report.categoryName : 'Unknown';\n\n                var item = '<li class=\"list-group-item d-flex justify-content-between align-items-center\" ' +\n                    'data-index=\"' + index + '\" data-slug=\"' + selected.slug + '\" data-source=\"' + selected.source + '\">' +\n                    '<div class=\"d-flex align-items-center flex-grow-1 min-width-0\">' +\n                    '<span class=\"drag-handle mr-2\" style=\"cursor: move;\"><i class=\"fa fa-bars text-muted\"></i></span>' +\n                    '<span class=\"badge badge-secondary mr-2\">' + (index + 1) + '</span>' +\n                    '<span class=\"text-truncate\" title=\"' + self.escapeHtml(name) + '\">' + self.escapeHtml(name) + '</span>' +\n                    '<small class=\"text-muted ml-2 d-none d-md-inline\">[' + self.escapeHtml(categoryName) + ']</small>' +\n                    '<span class=\"badge badge-' + (selected.source === 'ai' ? 'info' : 'primary') + ' ml-2\">' +\n                    selected.source.toUpperCase() + '</span>' +\n                    '</div>' +\n                    '<button type=\"button\" class=\"btn btn-sm btn-outline-danger report-selector-remove ml-2\" title=\"' +\n                    self.strings.removereport + '\">' +\n                    '<i class=\"fa fa-times\"></i>' +\n                    '</button>' +\n                    '</li>';\n\n                list.append(item);\n            });\n\n            this.updateListDisplay();\n            this.initSortable();\n        },\n\n        /**\n         * Update list display (show/hide empty state).\n         */\n        updateListDisplay: function() {\n            var list = this.container.find('.report-selector-list');\n            var empty = this.container.find('.report-selector-empty');\n\n            if (this.selectedReports.length > 0) {\n                list.show();\n                empty.hide();\n            } else {\n                list.hide();\n                empty.show();\n            }\n        },\n\n        /**\n         * Update the selected count badge.\n         */\n        updateSelectedCount: function() {\n            var count = this.selectedReports.length;\n            var text = count === 1 ? '1 selected' : count + ' selected';\n            this.container.find('.report-count').text(text);\n        },\n\n        /**\n         * Initialize sortable for drag-and-drop reordering.\n         */\n        initSortable: function() {\n            var self = this;\n            var list = this.container.find('.report-selector-list');\n\n            // Simple sortable implementation using jQuery UI if available\n            if ($.fn.sortable) {\n                list.sortable({\n                    handle: '.drag-handle',\n                    update: function() {\n                        self.updateOrderFromDOM();\n                    }\n                });\n            } else {\n                // Fallback: manual drag handling\n                this.initManualSort();\n            }\n        },\n\n        /**\n         * Initialize manual sort without jQuery UI.\n         */\n        initManualSort: function() {\n            var self = this;\n            var list = this.container.find('.report-selector-list');\n            var dragItem = null;\n\n            list.on('dragstart', 'li', function(e) {\n                dragItem = this;\n                $(this).addClass('dragging opacity-50');\n                e.originalEvent.dataTransfer.effectAllowed = 'move';\n            });\n\n            list.on('dragend', 'li', function() {\n                $(this).removeClass('dragging opacity-50');\n                self.updateOrderFromDOM();\n            });\n\n            list.on('dragover', 'li', function(e) {\n                e.preventDefault();\n                var rect = this.getBoundingClientRect();\n                var midY = rect.top + rect.height / 2;\n                if (e.originalEvent.clientY < midY) {\n                    $(this).before(dragItem);\n                } else {\n                    $(this).after(dragItem);\n                }\n            });\n\n            // Make items draggable\n            list.find('li').attr('draggable', 'true');\n        },\n\n        /**\n         * Update the order from DOM after sorting.\n         */\n        updateOrderFromDOM: function() {\n            var self = this;\n            var newOrder = [];\n\n            this.container.find('.report-selector-list li').each(function() {\n                var slug = $(this).data('slug');\n                var source = $(this).data('source');\n                var existing = self.selectedReports.find(function(s) {\n                    return s.slug === slug && s.source === source;\n                });\n                if (existing) {\n                    newOrder.push(existing);\n                }\n            });\n\n            this.selectedReports = newOrder;\n            this.saveSelection();\n            this.renderSelectedList();\n        },\n\n        /**\n         * Bind event handlers.\n         */\n        bindEvents: function() {\n            var self = this;\n            var input = this.container.find('.report-search-input');\n            var dropdown = this.container.find('.report-search-dropdown');\n\n            // Focus on input opens dropdown\n            input.on('focus', function() {\n                self.openDropdown();\n            });\n\n            // Input changes trigger search\n            input.on('input', function() {\n                var query = $(this).val();\n                self.openDropdown();\n                self.handleSearch(query);\n            });\n\n            // Keyboard navigation\n            input.on('keydown', function(e) {\n                var items = self.container.find('.report-search-item');\n                var maxIndex = items.length - 1;\n\n                switch (e.keyCode) {\n                    case 40: // Down arrow\n                        e.preventDefault();\n                        if (!self.isDropdownOpen) {\n                            self.openDropdown();\n                        }\n                        self.highlightedIndex = Math.min(self.highlightedIndex + 1, maxIndex);\n                        self.updateHighlight();\n                        break;\n\n                    case 38: // Up arrow\n                        e.preventDefault();\n                        self.highlightedIndex = Math.max(self.highlightedIndex - 1, 0);\n                        self.updateHighlight();\n                        break;\n\n                    case 13: // Enter\n                        e.preventDefault();\n                        if (self.highlightedIndex >= 0) {\n                            self.selectHighlightedItem();\n                        }\n                        break;\n\n                    case 27: // Escape\n                        e.preventDefault();\n                        self.closeDropdown();\n                        input.blur();\n                        break;\n\n                    case 9: // Tab\n                        self.closeDropdown();\n                        break;\n                }\n            });\n\n            // Click on dropdown item\n            dropdown.on('click', '.report-search-item', function() {\n                var slug = $(this).data('slug');\n                var source = $(this).data('source');\n                var report = self.reports.find(function(r) {\n                    return r.slug === slug && r.source === source;\n                });\n                if (report) {\n                    self.addReport(report);\n                }\n            });\n\n            // Click outside closes dropdown\n            $(document).on('click', function(e) {\n                if (!$(e.target).closest(self.container).length) {\n                    self.closeDropdown();\n                }\n            });\n\n            // Remove report button\n            this.container.on('click', '.report-selector-remove', function(e) {\n                e.stopPropagation();\n                var item = $(this).closest('li');\n                var slug = item.data('slug');\n                var source = item.data('source');\n                self.removeReport(slug, source);\n            });\n\n            // Display mode change - show/hide containers\n            $('[name=\"config_display_mode\"]').on('change', function() {\n                var mode = $(this).val();\n                if (mode === 'kpi') {\n                    $('#kpi-report-selector-container').show();\n                    $('#tabs-report-selector-container').hide();\n                } else if (mode === 'tabs') {\n                    $('#kpi-report-selector-container').hide();\n                    $('#tabs-report-selector-container').show();\n                } else {\n                    $('#kpi-report-selector-container').hide();\n                    $('#tabs-report-selector-container').hide();\n                }\n            }).trigger('change');\n        },\n\n        /**\n         * Remove a report from selection.\n         *\n         * @param {string} slug\n         * @param {string} source\n         */\n        removeReport: function(slug, source) {\n            this.selectedReports = this.selectedReports.filter(function(s) {\n                return !(s.slug === slug && s.source === source);\n            });\n\n            this.saveSelection();\n            this.updateSelectedCount();\n            this.filteredReports = this.getAvailableReports();\n            this.renderSelectedList();\n\n            // Re-render dropdown if open\n            if (this.isDropdownOpen) {\n                var query = this.container.find('.report-search-input').val();\n                this.filteredReports = this.filterReports(query);\n                this.renderSearchResults(query);\n            }\n        },\n\n        /**\n         * Save selection to textarea.\n         */\n        saveSelection: function() {\n            this.textarea.val(JSON.stringify(this.selectedReports));\n        },\n\n        /**\n         * Escape HTML special characters.\n         *\n         * @param {string} text\n         * @return {string}\n         */\n        escapeHtml: function(text) {\n            if (!text) {\n                return '';\n            }\n            var div = document.createElement('div');\n            div.textContent = text;\n            return div.innerHTML;\n        }\n    };\n\n    /**\n     * AlertsManager class for managing multiple alert configurations.\n     *\n     * @param {Object} options Configuration options\n     */\n    var AlertsManager = function(options) {\n        this.apiKey = options.apiKey || '';\n        this.container = null;\n        this.textarea = null;\n        this.alerts = [];\n        this.reports = [];\n        this.filteredReports = [];\n        this.operators = {};\n        this.intervals = {};\n        this.cooldowns = {};\n        this.roles = {};\n        this.editingIndex = -1;\n        this.isDropdownOpen = false;\n        this.searchTimeout = null;\n        this.strings = {};\n\n        this.init();\n    };\n\n    AlertsManager.prototype = {\n        /**\n         * Initialize the alerts manager.\n         */\n        init: function() {\n            var self = this;\n\n            this.container = $('#alerts-manager-container');\n            this.textarea = $('#id_config_alerts_json');\n\n            if (!this.container.length) {\n                return;\n            }\n\n            // Load language strings first, then proceed with initialization.\n            this.loadStrings().then(function() {\n                // Load configuration data from container attributes.\n                self.operators = JSON.parse(self.container.attr('data-operators') || '{}');\n                self.intervals = JSON.parse(self.container.attr('data-intervals') || '{}');\n                self.cooldowns = JSON.parse(self.container.attr('data-cooldowns') || '{}');\n                self.roles = JSON.parse(self.container.attr('data-roles') || '{}');\n\n                // Load existing alerts.\n                var existingAlerts = JSON.parse(self.container.attr('data-existing-alerts') || '[]');\n                self.alerts = existingAlerts;\n\n                // Populate select options.\n                self.populateSelectOptions();\n\n                // Fetch reports for the dropdown.\n                self.fetchReports();\n\n                // Bind events.\n                self.bindEvents();\n\n                // Initial render.\n                self.renderAlertsList();\n                self.saveToTextarea();\n\n                // Show/hide based on alerts_enabled checkbox.\n                self.handleAlertsEnabledToggle();\n            });\n        },\n\n        /**\n         * Load language strings.\n         *\n         * @return {Promise}\n         */\n        loadStrings: function() {\n            var self = this;\n            return Str.get_strings([\n                {key: 'edit_alert', component: 'block_adeptus_insights'},\n                {key: 'delete_alert', component: 'block_adeptus_insights'},\n                {key: 'alert_delete_confirm', component: 'block_adeptus_insights'},\n                {key: 'add_new_alert', component: 'block_adeptus_insights'},\n                {key: 'alert_disabled', component: 'block_adeptus_insights'},\n                {key: 'config_add_alert', component: 'block_adeptus_insights'}\n            ]).then(function(strings) {\n                self.strings = {\n                    editAlert: strings[0],\n                    deleteAlert: strings[1],\n                    deleteConfirm: strings[2],\n                    addNewAlert: strings[3],\n                    disabled: strings[4],\n                    addAlert: strings[5]\n                };\n            });\n        },\n\n        /**\n         * Populate select element options.\n         */\n        populateSelectOptions: function() {\n            var self = this;\n\n            // Populate operators.\n            var operatorSelect = $('#alert-edit-operator');\n            operatorSelect.empty();\n            $.each(this.operators, function(key, value) {\n                operatorSelect.append($('<option>', {value: key, text: value}));\n            });\n\n            // Populate intervals.\n            var intervalSelect = $('#alert-edit-interval');\n            intervalSelect.empty();\n            $.each(this.intervals, function(key, value) {\n                intervalSelect.append($('<option>', {value: key, text: value}));\n            });\n\n            // Populate cooldowns.\n            var cooldownSelect = $('#alert-edit-cooldown');\n            cooldownSelect.empty();\n            $.each(this.cooldowns, function(key, value) {\n                cooldownSelect.append($('<option>', {value: key, text: value}));\n            });\n\n            // Populate roles.\n            var rolesSelect = $('#alert-edit-notify-roles');\n            rolesSelect.empty();\n            $.each(this.roles, function(key, value) {\n                rolesSelect.append($('<option>', {value: key, text: value}));\n            });\n        },\n\n        /**\n         * Fetch reports from the API.\n         */\n        fetchReports: function() {\n            var self = this;\n\n            if (!this.apiKey) {\n                return;\n            }\n\n            var baseUrl = 'https://a360backend.stagingwithswift.com/api/v1';\n\n            $.when(\n                $.ajax({\n                    url: baseUrl + '/wizard-reports',\n                    method: 'GET',\n                    headers: {\n                        'Authorization': 'Bearer ' + this.apiKey,\n                        'Accept': 'application/json'\n                    },\n                    timeout: 15000\n                }),\n                $.ajax({\n                    url: baseUrl + '/ai-reports',\n                    method: 'GET',\n                    headers: {\n                        'Authorization': 'Bearer ' + this.apiKey,\n                        'Accept': 'application/json'\n                    },\n                    timeout: 15000\n                })\n            ).then(function(wizardResult, aiResult) {\n                var allReports = [];\n\n                var wizardReports = wizardResult[0].reports || wizardResult[0].data || [];\n                wizardReports.forEach(function(r) {\n                    r.source = 'wizard';\n                    r.displayName = r.name || r.title || r.display_name || r.slug;\n                    r.categoryName = r.category_info ? r.category_info.name : 'General';\n                    allReports.push(r);\n                });\n\n                var aiReports = aiResult[0].reports || aiResult[0].data || [];\n                aiReports.forEach(function(r) {\n                    r.source = 'ai';\n                    r.displayName = r.name || r.title || r.display_name || r.slug;\n                    r.categoryName = r.category_info ? r.category_info.name : 'AI Generated';\n                    allReports.push(r);\n                });\n\n                allReports.sort(function(a, b) {\n                    return a.displayName.localeCompare(b.displayName);\n                });\n\n                self.reports = allReports;\n                self.filteredReports = allReports;\n            }).fail(function() {\n                Notification.addNotification({\n                    message: 'Failed to load reports for alerts',\n                    type: 'error'\n                });\n            });\n        },\n\n        /**\n         * Handle alerts_enabled checkbox toggle.\n         */\n        handleAlertsEnabledToggle: function() {\n            var self = this;\n            var checkbox = $('[name=\"config_alerts_enabled\"]');\n            var displayMode = $('[name=\"config_display_mode\"]');\n\n            var updateVisibility = function() {\n                var enabled = checkbox.is(':checked');\n                var isKpi = displayMode.val() === 'kpi';\n\n                if (enabled && isKpi) {\n                    self.container.show();\n                } else {\n                    self.container.hide();\n                }\n            };\n\n            checkbox.on('change', updateVisibility);\n            displayMode.on('change', updateVisibility);\n            updateVisibility();\n        },\n\n        /**\n         * Bind event handlers.\n         */\n        bindEvents: function() {\n            var self = this;\n\n            // Add alert button.\n            this.container.on('click', '#add-alert-btn', function() {\n                self.openEditPanel(-1);\n            });\n\n            // Edit alert button.\n            this.container.on('click', '.alert-edit-btn', function() {\n                var index = $(this).closest('.alert-item').data('index');\n                self.openEditPanel(index);\n            });\n\n            // Delete alert button.\n            this.container.on('click', '.alert-delete-btn', function() {\n                var index = $(this).closest('.alert-item').data('index');\n                if (confirm(self.strings.deleteConfirm)) {\n                    self.deleteAlert(index);\n                }\n            });\n\n            // Toggle alert enabled/disabled.\n            this.container.on('change', '.alert-enabled-toggle', function() {\n                var index = $(this).closest('.alert-item').data('index');\n                self.alerts[index].enabled = $(this).is(':checked');\n                self.saveToTextarea();\n                self.renderAlertsList();\n            });\n\n            // Panel close buttons.\n            this.container.on('click', '.alert-panel-close, .alert-panel-cancel', function() {\n                self.closeEditPanel();\n            });\n\n            // Panel save button.\n            this.container.on('click', '.alert-panel-save', function() {\n                self.saveEditPanel();\n            });\n\n            // Toggle email addresses visibility based on notify_email checkbox.\n            $('#alert-edit-notify-email').on('change', function() {\n                if ($(this).is(':checked')) {\n                    $('#email-addresses-group').show();\n                } else {\n                    $('#email-addresses-group').hide();\n                }\n            });\n\n            // Report search input.\n            var searchInput = $('#alert-edit-report-search');\n            var dropdown = $('#alert-report-dropdown');\n\n            searchInput.on('focus', function() {\n                self.openReportDropdown();\n            });\n\n            searchInput.on('input', function() {\n                var query = $(this).val();\n                self.handleReportSearch(query);\n            });\n\n            searchInput.on('keydown', function(e) {\n                if (e.keyCode === 27) { // Escape\n                    self.closeReportDropdown();\n                }\n            });\n\n            dropdown.on('click', '.report-dropdown-item', function() {\n                var slug = $(this).data('slug');\n                var name = $(this).data('name');\n                self.selectReport(slug, name);\n            });\n\n            // Close dropdown when clicking outside.\n            $(document).on('click', function(e) {\n                if (!$(e.target).closest('#alert-edit-report-search, #alert-report-dropdown').length) {\n                    self.closeReportDropdown();\n                }\n            });\n        },\n\n        /**\n         * Render the alerts list.\n         */\n        renderAlertsList: function() {\n            var self = this;\n            var list = $('#alerts-list');\n            var emptyState = list.find('.alerts-empty');\n\n            // Clear existing items (except empty state).\n            list.find('.alert-item').remove();\n\n            if (this.alerts.length === 0) {\n                emptyState.show();\n            } else {\n                emptyState.hide();\n\n                this.alerts.forEach(function(alert, index) {\n                    var reportName = alert.report_name || alert.report_slug;\n                    var alertName = alert.alert_name || reportName;\n                    var operatorLabel = self.operators[alert.operator] || alert.operator;\n\n                    // Build threshold display.\n                    var thresholds = [];\n                    if (alert.warning_value !== null && alert.warning_value !== '') {\n                        thresholds.push('Warning: ' + alert.warning_value);\n                    }\n                    if (alert.critical_value !== null && alert.critical_value !== '') {\n                        thresholds.push('Critical: ' + alert.critical_value);\n                    }\n                    var thresholdText = thresholds.join(', ') || 'No thresholds set';\n\n                    // Get interval label.\n                    var intervalLabel = self.intervals[alert.check_interval] || alert.check_interval + 's';\n\n                    // Status badge.\n                    var statusBadge = '';\n                    if (alert.current_status === 'warning') {\n                        statusBadge = '<span class=\"badge badge-warning ml-2\">Warning</span>';\n                    } else if (alert.current_status === 'critical') {\n                        statusBadge = '<span class=\"badge badge-danger ml-2\">Critical</span>';\n                    } else if (alert.current_status) {\n                        statusBadge = '<span class=\"badge badge-success ml-2\">OK</span>';\n                    }\n\n                    var html = '<div class=\"alert-item card mb-2\" data-index=\"' + index + '\">' +\n                        '<div class=\"card-body py-2 px-3\">' +\n                        '<div class=\"d-flex justify-content-between align-items-start\">' +\n                        '<div class=\"flex-grow-1\">' +\n                        '<div class=\"d-flex align-items-center mb-1\">' +\n                        '<strong>' + self.escapeHtml(alertName) + '</strong>' +\n                        statusBadge +\n                        (alert.enabled ? '' : '<span class=\"badge badge-secondary ml-2\">' + self.strings.disabled + '</span>') +\n                        '</div>' +\n                        '<small class=\"text-muted d-block\">' + self.escapeHtml(reportName) + '</small>' +\n                        '<small class=\"text-muted d-block\">' + self.escapeHtml(operatorLabel) + ' | ' +\n                        thresholdText + ' | ' + intervalLabel + '</small>' +\n                        '</div>' +\n                        '<div class=\"alert-actions d-flex align-items-center\">' +\n                        '<div class=\"custom-control custom-switch mr-2\">' +\n                        '<input type=\"checkbox\" class=\"custom-control-input alert-enabled-toggle\" ' +\n                        'id=\"alert-enabled-' + index + '\"' + (alert.enabled ? ' checked' : '') + '>' +\n                        '<label class=\"custom-control-label\" for=\"alert-enabled-' + index + '\"></label>' +\n                        '</div>' +\n                        '<button type=\"button\" class=\"btn btn-sm btn-outline-primary alert-edit-btn mr-1\" title=\"' + self.strings.editAlert + '\">' +\n                        '<i class=\"fa fa-pencil\"></i>' +\n                        '</button>' +\n                        '<button type=\"button\" class=\"btn btn-sm btn-outline-danger alert-delete-btn\" title=\"' + self.strings.deleteAlert + '\">' +\n                        '<i class=\"fa fa-trash\"></i>' +\n                        '</button>' +\n                        '</div>' +\n                        '</div>' +\n                        '</div>' +\n                        '</div>';\n\n                    list.append(html);\n                });\n            }\n\n            // Update count badge.\n            this.container.find('.alerts-count').text(this.alerts.length);\n        },\n\n        /**\n         * Open the edit panel for an alert.\n         *\n         * @param {number} index Alert index (-1 for new)\n         */\n        openEditPanel: function(index) {\n            var panel = $('#alert-edit-panel');\n            this.editingIndex = index;\n\n            // Reset form.\n            $('#alert-edit-report').val('');\n            $('#alert-edit-report-search').val('');\n            $('#alert-edit-report-display').text('');\n            $('#alert-edit-name').val('');\n            $('#alert-edit-operator').val('gt');\n            $('#alert-edit-warning').val('');\n            $('#alert-edit-critical').val('');\n            $('#alert-edit-interval').val('3600');\n            $('#alert-edit-cooldown').val('3600');\n            $('#alert-edit-notify-warning').prop('checked', true);\n            $('#alert-edit-notify-critical').prop('checked', true);\n            $('#alert-edit-notify-recovery').prop('checked', true);\n            $('#alert-edit-notify-email').prop('checked', false);\n            $('#alert-edit-email-addresses').val('');\n            $('#email-addresses-group').hide();\n            $('#alert-edit-notify-roles').val([]);\n\n            // Populate if editing existing.\n            if (index >= 0 && this.alerts[index]) {\n                var alert = this.alerts[index];\n                $('#alert-edit-report').val(alert.report_slug);\n                $('#alert-edit-report-search').val(alert.report_name || alert.report_slug);\n                $('#alert-edit-report-display').text('Selected: ' + (alert.report_name || alert.report_slug));\n                $('#alert-edit-name').val(alert.alert_name || '');\n                $('#alert-edit-operator').val(alert.operator || 'gt');\n                $('#alert-edit-warning').val(alert.warning_value || '');\n                $('#alert-edit-critical').val(alert.critical_value || '');\n                $('#alert-edit-interval').val(alert.check_interval || 3600);\n                $('#alert-edit-cooldown').val(alert.cooldown_seconds || 3600);\n                $('#alert-edit-notify-warning').prop('checked', alert.notify_on_warning !== false);\n                $('#alert-edit-notify-critical').prop('checked', alert.notify_on_critical !== false);\n                $('#alert-edit-notify-recovery').prop('checked', alert.notify_on_recovery !== false);\n                $('#alert-edit-notify-email').prop('checked', !!alert.notify_email);\n                $('#alert-edit-email-addresses').val(alert.notify_emails || '');\n                if (alert.notify_email) {\n                    $('#email-addresses-group').show();\n                }\n                $('#alert-edit-notify-roles').val(alert.notify_roles || []);\n\n                panel.find('.alert-panel-title').text(this.strings.editAlert);\n            } else {\n                panel.find('.alert-panel-title').text(this.strings.addNewAlert);\n            }\n\n            panel.show();\n        },\n\n        /**\n         * Close the edit panel.\n         */\n        closeEditPanel: function() {\n            $('#alert-edit-panel').hide();\n            this.editingIndex = -1;\n        },\n\n        /**\n         * Save the edit panel data.\n         */\n        saveEditPanel: function() {\n            var reportSlug = $('#alert-edit-report').val();\n            var reportName = $('#alert-edit-report-search').val();\n            var warningValue = $('#alert-edit-warning').val();\n            var criticalValue = $('#alert-edit-critical').val();\n\n            // Validation.\n            if (!reportSlug) {\n                Notification.addNotification({\n                    message: 'Please select a report to monitor.',\n                    type: 'error'\n                });\n                return;\n            }\n\n            if (!warningValue && !criticalValue) {\n                Notification.addNotification({\n                    message: 'At least one threshold (warning or critical) is required.',\n                    type: 'error'\n                });\n                return;\n            }\n\n            var alertData = {\n                report_slug: reportSlug,\n                report_name: reportName,\n                alert_name: $('#alert-edit-name').val(),\n                operator: $('#alert-edit-operator').val(),\n                warning_value: warningValue ? parseFloat(warningValue) : null,\n                critical_value: criticalValue ? parseFloat(criticalValue) : null,\n                check_interval: parseInt($('#alert-edit-interval').val(), 10),\n                cooldown_seconds: parseInt($('#alert-edit-cooldown').val(), 10),\n                notify_on_warning: $('#alert-edit-notify-warning').is(':checked'),\n                notify_on_critical: $('#alert-edit-notify-critical').is(':checked'),\n                notify_on_recovery: $('#alert-edit-notify-recovery').is(':checked'),\n                notify_email: $('#alert-edit-notify-email').is(':checked'),\n                notify_emails: $('#alert-edit-email-addresses').val().trim(),\n                notify_roles: $('#alert-edit-notify-roles').val() || [],\n                enabled: true\n            };\n\n            if (this.editingIndex >= 0) {\n                // Update existing alert, preserve ID and status.\n                alertData.id = this.alerts[this.editingIndex].id;\n                alertData.current_status = this.alerts[this.editingIndex].current_status;\n                alertData.enabled = this.alerts[this.editingIndex].enabled;\n                this.alerts[this.editingIndex] = alertData;\n            } else {\n                // Add new alert.\n                alertData.current_status = 'ok';\n                this.alerts.push(alertData);\n            }\n\n            this.saveToTextarea();\n            this.renderAlertsList();\n            this.closeEditPanel();\n        },\n\n        /**\n         * Delete an alert.\n         *\n         * @param {number} index Alert index\n         */\n        deleteAlert: function(index) {\n            this.alerts.splice(index, 1);\n            this.saveToTextarea();\n            this.renderAlertsList();\n        },\n\n        /**\n         * Save alerts to the hidden textarea.\n         */\n        saveToTextarea: function() {\n            this.textarea.val(JSON.stringify(this.alerts));\n        },\n\n        /**\n         * Open the report dropdown.\n         */\n        openReportDropdown: function() {\n            if (this.isDropdownOpen) {\n                return;\n            }\n\n            this.isDropdownOpen = true;\n            var dropdown = $('#alert-report-dropdown');\n            var input = $('#alert-edit-report-search');\n\n            // Position dropdown.\n            dropdown.css('width', input.outerWidth() + 'px');\n            dropdown.show();\n\n            this.filteredReports = this.reports;\n            this.renderReportDropdown('');\n        },\n\n        /**\n         * Close the report dropdown.\n         */\n        closeReportDropdown: function() {\n            this.isDropdownOpen = false;\n            $('#alert-report-dropdown').hide();\n        },\n\n        /**\n         * Handle report search input.\n         *\n         * @param {string} query Search query\n         */\n        handleReportSearch: function(query) {\n            var self = this;\n\n            if (this.searchTimeout) {\n                clearTimeout(this.searchTimeout);\n            }\n\n            this.searchTimeout = setTimeout(function() {\n                self.filteredReports = self.filterReports(query);\n                self.renderReportDropdown(query);\n            }, 150);\n        },\n\n        /**\n         * Filter reports based on search query.\n         *\n         * @param {string} query Search query\n         * @return {Array} Filtered reports\n         */\n        filterReports: function(query) {\n            if (!query || query.length < 1) {\n                return this.reports;\n            }\n\n            query = query.toLowerCase().trim();\n            var terms = query.split(/\\s+/);\n\n            return this.reports.filter(function(report) {\n                var searchText = (\n                    report.displayName + ' ' +\n                    report.categoryName + ' ' +\n                    report.source + ' ' +\n                    (report.slug || '')\n                ).toLowerCase();\n\n                return terms.every(function(term) {\n                    return searchText.indexOf(term) !== -1;\n                });\n            }).slice(0, 30);\n        },\n\n        /**\n         * Render the report dropdown.\n         *\n         * @param {string} query Current search query\n         */\n        renderReportDropdown: function(query) {\n            var self = this;\n            var dropdown = $('#alert-report-dropdown');\n            dropdown.empty();\n\n            if (this.filteredReports.length === 0) {\n                dropdown.append('<div class=\"p-3 text-muted text-center\">No matching reports found</div>');\n                return;\n            }\n\n            // Group by category.\n            var byCategory = {};\n            this.filteredReports.forEach(function(report) {\n                var cat = report.categoryName || 'Other';\n                if (!byCategory[cat]) {\n                    byCategory[cat] = [];\n                }\n                byCategory[cat].push(report);\n            });\n\n            Object.keys(byCategory).sort().forEach(function(category) {\n                dropdown.append(\n                    '<div class=\"px-3 py-1 bg-light border-bottom\">' +\n                    '<small class=\"text-muted font-weight-bold\">' + self.escapeHtml(category) + '</small>' +\n                    '</div>'\n                );\n\n                byCategory[category].forEach(function(report) {\n                    var sourceBadge = report.source === 'ai'\n                        ? '<span class=\"badge badge-info ml-2\">AI</span>'\n                        : '<span class=\"badge badge-primary ml-2\">Wizard</span>';\n\n                    dropdown.append(\n                        '<div class=\"report-dropdown-item px-3 py-2\" style=\"cursor:pointer;\" ' +\n                        'data-slug=\"' + report.slug + '\" data-name=\"' + self.escapeHtml(report.displayName) + '\">' +\n                        '<span>' + self.escapeHtml(report.displayName) + '</span>' +\n                        sourceBadge +\n                        '</div>'\n                    );\n                });\n            });\n\n            // Add hover effects.\n            dropdown.find('.report-dropdown-item').hover(\n                function() { $(this).addClass('bg-light'); },\n                function() { $(this).removeClass('bg-light'); }\n            );\n        },\n\n        /**\n         * Select a report from the dropdown.\n         *\n         * @param {string} slug Report slug\n         * @param {string} name Report display name\n         */\n        selectReport: function(slug, name) {\n            $('#alert-edit-report').val(slug);\n            $('#alert-edit-report-search').val(name);\n            $('#alert-edit-report-display').text('Selected: ' + name);\n            this.closeReportDropdown();\n        },\n\n        /**\n         * Escape HTML special characters.\n         *\n         * @param {string} text\n         * @return {string}\n         */\n        escapeHtml: function(text) {\n            if (!text) {\n                return '';\n            }\n            var div = document.createElement('div');\n            div.textContent = text;\n            return div.innerHTML;\n        }\n    };\n\n    return {\n        /**\n         * Initialize report selectors for the edit form.\n         *\n         * @param {Object} options Configuration options\n         */\n        init: function(options) {\n            // Initialize KPI report selector.\n            new ReportSelector({\n                mode: 'kpi',\n                apiKey: options.apiKey,\n                containerId: 'kpi-report-selector-container',\n                textareaName: 'config_kpi_selected_reports'\n            });\n\n            // Initialize Tabs report selector.\n            new ReportSelector({\n                mode: 'tabs',\n                apiKey: options.apiKey,\n                containerId: 'tabs-report-selector-container',\n                textareaName: 'config_tabs_selected_reports'\n            });\n\n            // Initialize Alerts manager.\n            new AlertsManager({\n                apiKey: options.apiKey\n            });\n        }\n    };\n});\n"],"names":["define","$","Str","Notification","ReportSelector","options","mode","apiKey","containerId","textareaName","container","textarea","reports","filteredReports","selectedReports","strings","searchTimeout","highlightedIndex","isDropdownOpen","init","prototype","self","this","length","loadExistingSelection","loadStrings","then","render","fetchReports","bindEvents","show","get_strings","key","component","addreport","removereport","noreportsselected","selectareport","loading","searchplaceholder","value","val","JSON","parse","e","html","Date","now","updateListDisplay","updateSelectedCount","find","hide","baseUrl","when","ajax","url","method","headers","timeout","wizardResult","aiResult","allReports","data","forEach","r","source","displayName","name","title","display_name","slug","categoryName","category_info","push","sort","a","b","localeCompare","getAvailableReports","renderSelectedList","fail","addNotification","message","type","filter","report","some","s","filterReports","query","available","terms","toLowerCase","trim","split","searchText","every","term","indexOf","slice","renderSearchResults","resultsContainer","emptyContainer","empty","byCategory","cat","index","Object","keys","category","append","escapeHtml","highlightedName","highlightMatch","sourceBadge","itemHtml","css","hover","addClass","parseInt","updateHighlight","removeClass","text","escaped","regex","RegExp","replace","items","item","eq","dropdown","itemTop","position","top","itemHeight","outerHeight","dropdownHeight","height","scrollTop","openDropdown","input","attr","closeDropdown","handleSearch","clearTimeout","setTimeout","selectHighlightedItem","addReport","saveSelection","list","selected","toUpperCase","initSortable","count","fn","sortable","handle","update","updateOrderFromDOM","initManualSort","dragItem","on","originalEvent","dataTransfer","effectAllowed","preventDefault","rect","getBoundingClientRect","midY","clientY","before","after","newOrder","each","existing","maxIndex","keyCode","Math","min","max","blur","document","target","closest","stopPropagation","removeReport","trigger","stringify","div","createElement","textContent","innerHTML","AlertsManager","alerts","operators","intervals","cooldowns","roles","editingIndex","existingAlerts","populateSelectOptions","renderAlertsList","saveToTextarea","handleAlertsEnabledToggle","editAlert","deleteAlert","deleteConfirm","addNewAlert","disabled","addAlert","operatorSelect","intervalSelect","cooldownSelect","rolesSelect","checkbox","displayMode","updateVisibility","enabled","is","isKpi","openEditPanel","confirm","closeEditPanel","saveEditPanel","searchInput","openReportDropdown","handleReportSearch","closeReportDropdown","selectReport","emptyState","remove","alert","reportName","report_name","report_slug","alertName","alert_name","operatorLabel","operator","thresholds","warning_value","critical_value","thresholdText","join","intervalLabel","check_interval","statusBadge","current_status","panel","prop","cooldown_seconds","notify_on_warning","notify_on_critical","notify_on_recovery","notify_email","notify_emails","notify_roles","reportSlug","warningValue","criticalValue","alertData","parseFloat","id","splice","outerWidth","renderReportDropdown"],"mappings":"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"}